#include "Links/S_udp_client/S_udp_client.hpp"

#include "Interfaces/Interface.hpp"

S_udp_client::S_udp_client() : Link() {}

S_udp_client::~S_udp_client() {}

void S_udp_client::step() {
  Link::step();
}

void S_udp_client::connect() {
  Link::connect();

  char buffer[100];
  char *message = "Hello Server";
  int sockfd, n;
  struct sockaddr_in servaddr;

  bzero(&servaddr, sizeof(servaddr));
  servaddr.sin_addr.s_addr = inet_addr(this->get_addr());
  servaddr.sin_port = htons(this->get_port());
  servaddr.sin_family = AF_INET;

  sockfd = socket(AF_INET, SOCK_DGRAM, 0);

  connect(sockfd, (struct sockaddr *)&servaddr, sizeof(servaddr));

  sendto(sockfd, message, MAXLINE, 0, (struct sockaddr *)NULL,
         sizeof(servaddr));

  recvfrom(sockfd, buffer, sizeof(buffer), 0, (struct sockaddr *)NULL, NULL);
}

void S_udp_client::disconnect() {
  Link::disconnect();
  close(sockfd);
}

// Get and set /////////////////////////////////////////////////////////////
